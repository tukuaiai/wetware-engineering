# 湿件工程技术规范 v0.1

## Wetware Engineering Technical Specification

**版本**: 0.1.0  
**发布日期**: 2025-12-28  
**状态**: 草案 (Draft)

---

## 文档目标

本规范定义了湿件工程（Wetware Engineering）的核心技术标准，使生物模块能够像软件组件一样被描述、组合、测试和复用。

---

## 第一部分：生物组件规范 (Bio-Component Spec)

### 1.1 组件元数据结构

每个生物组件必须包含以下标准化描述：

```yaml
component:
  # === 基础标识 ===
  id: string                    # 唯一标识符，格式: {type}-{source}-{version}
  name: string                  # 人类可读名称
  version: semver               # 语义化版本号 (major.minor.patch)
  type: enum                    # 组件类型
    - actuator                  # 执行器（肌肉、泵）
    - sensor                    # 传感器（神经、感光）
    - processor                 # 处理器（神经节、类脑）
    - metabolic                 # 代谢单元（肝、肾）
    - structural                # 结构支撑（骨骼、外壳）
  
  # === 来源信息 ===
  source:
    organism: string            # 来源生物（human/mouse/synthetic）
    tissue_type: string         # 组织类型
    cell_line: string           # 细胞系（如适用）
    genetic_modification: []    # 基因修饰列表
    culture_protocol: uri       # 培养协议引用
  
  # === 功能定义 ===
  function:
    primary: string             # 主要功能描述
    capabilities: []            # 能力列表
    limitations: []             # 已知限制
```

### 1.2 接口定义 (Interface Definition)

```yaml
  interface:
    # === 输入接口 ===
    inputs:
      - id: string
        type: enum
          - electrical          # 电信号
          - chemical            # 化学信号（激素/神经递质）
          - mechanical          # 机械刺激
          - optical             # 光刺激
          - thermal             # 温度
          - perfusion           # 灌流（营养/氧气）
        
        parameters:
          range: [min, max]     # 工作范围
          unit: string          # 单位
          resolution: number    # 分辨率
          response_time: number # 响应时间 (ms)
        
        required: boolean       # 是否必需
        default: any            # 默认值
    
    # === 输出接口 ===
    outputs:
      - id: string
        type: enum              # 同输入类型
        parameters:
          range: [min, max]
          unit: string
          precision: number     # 精度
          latency: number       # 延迟 (ms)
        
        monitoring:             # 监测要求
          frequency: number     # 采样频率 (Hz)
          metrics: []           # 监测指标列表
```

### 1.3 环境需求 (Environmental Requirements)

```yaml
  requirements:
    # === 物理环境 ===
    physical:
      temperature:
        range: [min, max]       # 温度范围 (°C)
        optimal: number         # 最优温度
        tolerance: number       # 容忍偏差
      
      pressure:
        range: [min, max]       # 压力范围 (mmHg/kPa)
      
      humidity:
        range: [min, max]       # 湿度范围 (%)
    
    # === 化学环境 ===
    chemical:
      pH:
        range: [min, max]
        optimal: number
      
      osmolarity:
        range: [min, max]       # mOsm/L
      
      oxygen:
        range: [min, max]       # % 或 mmHg
      
      glucose:
        range: [min, max]       # mM
    
    # === 生物相容性 ===
    biocompatibility:
      immune_isolation: boolean # 是否需要免疫隔离
      rejection_risk: enum      # low/medium/high
      toxic_metabolites: []     # 毒性代谢产物列表
      cross_talk_risk: []       # 串扰风险列表
```

### 1.4 性能指标 (Performance Metrics)

```yaml
  performance:
    # === 功能性能 ===
    functional:
      output_range: [min, max]  # 输出范围
      response_time: number     # 响应时间 (ms)
      precision: number         # 精度 (%)
      repeatability: number     # 重复性 (CV%)
      
    # === 可靠性 ===
    reliability:
      lifetime:
        mean: number            # 平均寿命 (天/周)
        distribution: string    # 分布类型
      
      failure_rate: number      # 失效率 (failures/hour)
      
      failure_modes:            # 失效模式列表
        - mode: string
          probability: number   # 概率
          detectability: enum   # easy/medium/hard
          impact: enum          # low/medium/high
    
    # === 资源消耗 ===
    resources:
      power:                    # 能量消耗
        baseline: number        # 基础功耗 (mW)
        active: number          # 活动功耗 (mW)
      
      nutrients:                # 营养消耗
        - compound: string
          rate: number          # 消耗速率 (µmol/min)
      
      waste:                    # 代谢废物
        - compound: string
          production_rate: number
```

### 1.5 测试与验证 (Testing & Validation)

```yaml
  testing:
    # === 单元测试 ===
    unit_tests:
      - test_id: string
        description: string
        protocol: uri           # 测试协议引用
        acceptance_criteria:    # 验收标准
          - metric: string
            threshold: number
            operator: enum      # >, <, ==, between
    
    # === 集成测试 ===
    integration_tests:
      compatible_components: [] # 已验证兼容的组件列表
      incompatible_components: [] # 不兼容组件
      
    # === 认证状态 ===
    certification:
      status: enum              # pending/certified/deprecated
      authority: string         # 认证机构
      date: date
      notes: string
```

---

## 第二部分：接口适配器标准 (Bio-Adapter Standard)

### 2.1 适配器分类

适配器用于连接不同接口类型的生物组件。

#### A. 供能适配器 (Power/Perfusion Adapters)

```yaml
adapter_type: perfusion
specification:
  input:
    type: external_pump
    medium: string              # 培养基类型
    flow_rate: [min, max]       # mL/min
  
  output:
    type: microfluidic_network
    channels: number
    pressure: [min, max]        # mmHg
    
  features:
    oxygenation: boolean
    temperature_control: boolean
    waste_removal: boolean
    
  compatibility:
    component_types: []         # 兼容组件类型
    max_components: number
```

#### B. 信号转换适配器 (Signal Conversion Adapters)

```yaml
adapter_type: signal_converter
specification:
  input_signal: enum            # electrical/chemical/optical
  output_signal: enum
  
  conversion:
    latency: number             # 转换延迟 (ms)
    fidelity: number            # 保真度 (%)
    bandwidth: number           # 带宽 (Hz)
    
  examples:
    - electrical_to_chemical:   # 电刺激 → 神经递质释放
        mechanism: "optogenetics"
    - chemical_to_electrical:   # 化学浓度 → 电信号
        mechanism: "biosensor"
```

#### C. 免疫隔离适配器 (Immune Isolation Adapters)

```yaml
adapter_type: immune_barrier
specification:
  barrier_type: enum
    - semipermeable_membrane
    - encapsulation_hydrogel
    - immunosuppressive_coating
  
  permeability:
    nutrients: high             # 小分子通过
    oxygen: high
    antibodies: low             # 免疫分子阻断
    cells: none
  
  biocompatibility:
    inflammation_index: number  # 炎症指数
    fibrosis_risk: enum         # low/medium/high
```

#### D. 机械耦合适配器 (Mechanical Coupling Adapters)

```yaml
adapter_type: mechanical_coupler
specification:
  input_force_range: [min, max] # mN
  output_force_range: [min, max]
  
  coupling_type: enum
    - rigid
    - compliant
    - programmable_stiffness
  
  degrees_of_freedom: number
  
  damping: number               # 阻尼系数
  hysteresis: number            # 迟滞 (%)
```

---

## 第三部分：生物DSL (Bio-DSL) 语法

### 3.1 基本语法

```
// === 组件声明 ===
COMPONENT <id> FROM <source> VERSION <version> AS <alias>

// === 接口连接 ===
CONNECT <component1>.<output_port> TO <component2>.<input_port>
  [VIA <adapter>]
  [WITH {parameter: value, ...}]

// === 运行时配置 ===
RUNTIME {
  perfusion: <perfusion_config>
  control: <control_config>
  monitoring: <monitoring_config>
}

// === 控制逻辑 ===
ON <event> DO <action>
WHEN <condition> THEN <action>
```

### 3.2 完整示例：双模块肌肉执行器

```biomodule
// ==========================================
// 项目：生物机械臂单元 v0.1
// 功能：双肌肉拮抗执行器 + 张力传感 + 闭环控制
// ==========================================

// === 1. 组件声明 ===

COMPONENT muscle-actuator-flexor FROM human-skeletal-v2.3 AS flexor {
  type: actuator,
  force_range: [0, 50] mN,
  response_time: 150 ms
}

COMPONENT muscle-actuator-extensor FROM human-skeletal-v2.3 AS extensor {
  type: actuator,
  force_range: [0, 50] mN,
  response_time: 150 ms
}

COMPONENT tension-sensor FROM synthetic-piezo-v1.1 AS sensor {
  type: sensor,
  range: [0, 100] mN,
  sampling_rate: 100 Hz
}

COMPONENT neural-controller FROM organoid-spinal-v0.8 AS controller {
  type: processor,
  input_channels: 2,
  output_channels: 2
}

// === 2. 适配器声明 ===

ADAPTER perfusion-hub FROM microfluidic-4ch-v1.0 AS perfusion {
  channels: 4,
  flow_rate: 0.5 mL/min per channel,
  medium: "DMEM + 10% FBS"
}

ADAPTER signal-converter FROM opto-electrical-v2.0 AS stim_adapter {
  input: electrical,
  output: optical,
  wavelength: 470 nm
}

// === 3. 连接拓扑 ===

// 控制器 → 肌肉
CONNECT controller.output_1 TO flexor.electrical_input
  VIA stim_adapter
  WITH {frequency: [1, 50] Hz, voltage: [0, 3] V}

CONNECT controller.output_2 TO extensor.electrical_input
  VIA stim_adapter
  WITH {frequency: [1, 50] Hz, voltage: [0, 3] V}

// 传感器 → 控制器（反馈）
CONNECT sensor.tension_output TO controller.input_1
  WITH {gain: 1.5, offset: 0}

// 供能连接
CONNECT perfusion.channel_1 TO flexor.perfusion_input
CONNECT perfusion.channel_2 TO extensor.perfusion_input
CONNECT perfusion.channel_3 TO controller.perfusion_input
CONNECT perfusion.channel_4 TO sensor.perfusion_input

// === 4. 运行时配置 ===

RUNTIME {
  perfusion: {
    temperature: 37 °C,
    pH: 7.4,
    oxygenation: true,
    waste_removal: continuous
  },
  
  control: {
    mode: "closed_loop",
    target: "position",
    pid_parameters: {
      Kp: 0.8,
      Ki: 0.2,
      Kd: 0.1
    }
  },
  
  monitoring: {
    log_interval: 10 s,
    metrics: [
      "flexor.force",
      "extensor.force",
      "sensor.tension",
      "controller.activity",
      "perfusion.flow_rate",
      "all.viability"
    ],
    alerts: {
      viability < 80%: "WARNING",
      tension > 90 mN: "CRITICAL"
    }
  },
  
  safety: {
    max_force: 100 mN,
    emergency_shutdown: {
      trigger: "viability < 50% OR tension > 120 mN",
      action: "STOP_ALL + PERFUSION_ONLY"
    }
  }
}

// === 5. 控制逻辑 ===

// 初始化
ON STARTUP DO {
  SET perfusion.flow_rate = 0.5 mL/min
  WAIT 300 s  // 平衡期
  SET controller.mode = "active"
}

// 目标追踪
WHEN target_position CHANGES THEN {
  error = target_position - sensor.tension
  controller.compute_pid(error)
}

// 疲劳检测
WHEN flexor.fatigue_index > 0.3 THEN {
  LOG "Flexor showing fatigue"
  REDUCE flexor.stimulation_frequency BY 20%
}

// 定期维护
EVERY 3600 s DO {
  RUN viability_check()
  IF any.viability < 85% THEN {
    INCREASE perfusion.flow_rate BY 10%
  }
}

// === 6. 测试协议 ===

TEST unit_response {
  description: "单肌肉响应测试"
  steps: [
    "刺激 flexor 10Hz, 2V, 1s",
    "测量力输出",
    "验证 response_time < 200ms",
    "验证 force IN [5, 15] mN"
  ]
}

TEST antagonist_coordination {
  description: "拮抗肌协调测试"
  steps: [
    "同时激活 flexor + extensor",
    "验证 力平衡 < 5 mN",
    "验证 无震荡"
  ]
}

TEST closed_loop_tracking {
  description: "闭环位置追踪"
  steps: [
    "设置正弦波目标 (0.5 Hz, ±20 mN)",
    "运行 60s",
    "验证 tracking_error < 3 mN RMS"
  ]
}

// ==========================================
// 预期性能指标
// ==========================================
EXPECTED_PERFORMANCE {
  position_accuracy: ±2 mN,
  bandwidth: 0-2 Hz,
  lifetime: 7-14 days,
  power_consumption: 50-100 mW
}
```

---

## 第四部分：版本管理与依赖

### 4.1 语义化版本控制

遵循 SemVer 2.0.0:
- **Major**: 接口不兼容的变更
- **Minor**: 向后兼容的功能新增
- **Patch**: 向后兼容的问题修复

### 4.2 依赖声明

```yaml
dependencies:
  components:
    - id: neural-controller
      version: "^0.8.0"        # 兼容 0.8.x
      source: "organoid-lab/spinal"
  
  adapters:
    - id: perfusion-hub
      version: "~1.0.0"        # 仅兼容 1.0.x
  
  protocols:
    - name: "standard-culture"
      version: "2.1"
      uri: "https://protocols.org/wetware/culture-v2.1"
```

---

## 第五部分：认证与测试体系

### 5.1 认证等级

- **Level 0**: 概念验证（单组件有限测试）
- **Level 1**: 基础认证（通过标准单元测试）
- **Level 2**: 集成认证（至少3种组合验证）
- **Level 3**: 生产就绪（长期稳定性数据）

### 5.2 测试金字塔

```
           /\        集成测试（组合系统）
          /  \       - 10+ 组件组合
         /    \      - 长期运行（7天+）
        /------\     
       /        \    接口测试（兼容性）
      /          \   - 不同适配器
     /            \  - 跨版本兼容
    /--------------\ 
   /                \ 单元测试（单组件）
  /                  \ - 功能验证
 /____________________\ - 环境容忍度
```

---

## 附录A：标准术语表

| 术语 | 英文 | 定义 |
|-----|------|------|
| 生物组件 | Bio-Component | 可独立功能的生物模块单元 |
| 湿件运行时 | Wetware Runtime | 负责组件调度、资源管理的系统 |
| 生物适配器 | Bio-Adapter | 连接不同接口的转换/隔离层 |
| 灌流系统 | Perfusion System | 为生物组件提供营养和氧气的循环系统 |
| 接口兼容性 | Interface Compatibility | 组件间能否直接或通过适配器连接 |
| 故障模式 | Failure Mode | 组件失效的具体表现形式 |

---

## 附录B：参考实现清单

### 当前可用参考实现：

1. **双肌肉执行器** (本文档示例)
   - 状态: Level 1 认证
   - 源代码: 见第三部分
   - 实验数据: [待补充]

2. **类器官感知单元** (开发中)
   - 视网膜类器官 + 光电转换
   - 状态: Level 0 (概念)

3. **代谢模块阵列** (规划中)
   - 肝/肾类器官组合
   - 目标: 药物代谢模拟

---

## 修订历史

| 版本 | 日期 | 变更说明 |
|-----|------|---------|
| 0.1.0 | 2025-12-28 | 初始草案发布 |

---

## 许可与贡献

**许可**: Creative Commons BY-SA 4.0  
**贡献**: 欢迎通过 GitHub 提交改进建议  
**联系**: [待添加]

---

**文档结束**

*湿件工程：让生命系统像软件一样可编程*